name: BUILD AND PUSH IMAGE TO DOCKER HUB
on:
 push:
   branches:
     - dev
jobs:
  build:
   runs-on: ubuntu-latest
   container:
    image: betrand1997/myapp
   steps:
     - name: login to docker hub 
       uses: actions/checkout@v2
       with:
         username: ${{secrets.DOCKER_USERNAME}}
         password: ${{secrts.DOCKER_PASSWORD}}
     - name: build container 
       run: docker build -t test .
     - name: tag container
       run: docker tag test betrand1999/test

     - name: run container 
       run: docker run -d -p 8080:80 betrand1999/test
     - name: check if container is running
       run: docker ps